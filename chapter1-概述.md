# 第一章

## 1.1 分布式存储概念

定义：分布式存储系统是大量普通PC服务器通过Internet互联，对外作为一个整体提供存储服务。

特点：
* 可扩展
* 低成本
* 高性能
* 易用

分布式存储涉及的技术主要来自两个领域：分布式系统以及数据库。

## 1.2 分布式存储分类

分布式存储分类：
* 非结构化数据
* 结构化数据
* 半结构化数据

本书将分布式存储系统分类：
* 分布式文件系统
* 分布式键值系统
* 分布式表格系统
* 分布式数据库

### 分布式文件系统

非结构化数据，如图片、视频等以对象的形式组织，对象之间没有关联，这样的数据一般称为Bolb（Binary Large Object）数据。
分布式文件系统用于存储Bolb对象，典型的系统有FaceBook Haystack以及Taobao File System（TFS）。
分布式文件系统也常作为分布式表格系统以及分布式数据库的底层存储，如google的GFS（Google File System）可以作为分布式表格系统Google Bigtable的底层存储，Amazon的EBS（Elastic Block Store）系统可以作为分布式数据库（Amazon RDS）的底层存储。
总体看，分布式文件系统存储三种类型的数据：Blob对象、定长块以及大文件。系统实现层面，分布式文件系统内部按照数据块（chunk）来组织数据，每个数据块的大小大致相同。
每个数据块可以包含多个Blob对象或者定长块，一个大文件也可以拆分为多个数据块。

### 分布式键值系统

分布式键值系统用于存储关系简单的半结构化数据，它只提供基于主键的CRUD功能。
典型的系统有Amazon Dynamo以及Taobao Tair。
分布式键值系统是分布式表格系统的一种简化实现，一般用作缓存，比如Taobao的Tair以及Memcache。
一致性哈希是分布式键值系统中常用的数据分布技术，因其被Amazon DynamoDB系统使用而出名。

### 分布式表格系统

分布式表格系统用于存储关系比较复杂的半结构化数据，与分布式键值系统相比，分布式表格系统不仅仅支持简单的CRUD，而且支持扫描某个主键范围。
分布式表格系统借鉴了很多关系型数据库的技术，例如支持某种程度上的事务，比如单行事务，某个实体组（Entity Group，一个用户下的所有数据往往构成一个实体组）下的多行事务。典型的系统包括Google Bigtable以及Megastore，Microsoft Azure Table Storage，Amazon DynamoDB等。
与分布式数据库相比，分布式表格系统主要支持针对单张表格的操作，不支持一些特别复杂的操作，比如多表关联，多表联接，嵌套子查询；另外，在分布式表格系统中，同一表格的多个数据行也不要求包含相同类型的列，适合半结构化数据。
分布式表格系统是一种很好的权衡，这类系统可以做到超大规模而且支持较多的功能，但实现较为复杂。

### 分布式数据库

分布式数据库一般从单机关系型数据库扩展而来，用于存储结构化数据。
典型的系统包括MySQL数据库分片（MySQL Sharding）集群，Amazon RDS以及Microsoft SQL Azure。
分布式数据库可扩展性往往受到限制，但并不绝对，如Google Spanner系统是一个支持多数据中心的分布式数据库，Alibaba的OceanBase系统也是一个支持自动扩展的分布式关系数据库。
为解决关系数据库面临的可扩展性、高并发以及性能方面的问题，可以考虑NoSQL，各种NoSQL各有独到之处，适合解决某种特定的问题。
